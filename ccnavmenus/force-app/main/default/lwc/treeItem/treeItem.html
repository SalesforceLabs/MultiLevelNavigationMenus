<!--
  Copyright (c) 2019, salesforce.com, inc.
  All rights reserved.
  SPDX-License-Identifier: MIT
  For full license text, see the LICENSE file in the repo root or https://opensource.org/licenses/MIT
 -->

 <template>
    <div role="ccnavMenu-treeItemCSS">
        <template if:true={isRoot}>
            <ul class={menuAlignmentClass}>
            <template for:each={children} for:item="item" for:index="index">
                <li class={liClass} key={item.node.key}> 
                    <template if:true={item.node.isLeaf}>
                        <c-tree-item
                            role="treeitem"
                            data-key={item.node.key}
                            key={item.node.key}
                            node-key={item.node.key}
                            aria-selected={item.selected}
                            aria-level={item.node.level}
                            label={item.node.label}
                            href={item.node.href}
                            target={item.node.target}
                            icon={item.node.icon}
                            icon-position={item.node.iconPosition}
                            metatext={item.node.metatext}
                            node-ref={item.node.nodeRef}
                            is-expanded={item.node.isExpanded}
                            is-disabled={item.node.isDisabled}
                            focused-child={item.node.focusedChild}
                            nodename={item.node.name}
                            is-leaf={item.node.isLeaf}
                            child-items={item.node.children}
                            level={nextLevel}
                            is-vertical={isVertical}
                            
                            menu-aria-announcement={menuAriaAnnouncement}

                            brand-navigation-color-text={brandNavigationColorText}
                            brand-navigation-bar-background-color={brandNavigationBarBackgroundColor}
                            brand-navigation-background-color={brandNavigationBackgroundColor}
                            font-family={fontFamily}
                            text-transform={textTransform}
                            top-level-item-spacing={topLevelItemSpacing}
                            menu-alignment={menuAlignment}

                            data-is-vertical={isVertical}
                            data-level={nextLevel}
                            data-role="treeitem"
                        >
                        </c-tree-item>
                    </template>
                    <template if:false={item.node.isLeaf}>
                        <c-tree-item
                            role="treeitem"
                            data-key={item.node.key}
                            key={item.node.key}
                            node-key={item.node.key}
                            aria-selected={item.selected}
                            aria-level={item.node.level}
                            label={item.node.label}
                            href={item.node.href}
                            target={item.node.target}
                            icon={item.node.icon}
                            icon-position={item.node.iconPosition}
                            metatext={item.node.metatext}
                            node-ref={item.node.nodeRef}
                            is-expanded={item.node.isExpanded}
                            is-disabled={item.node.isDisabled}
                            focused-child={item.node.focusedChild}
                            nodename={item.node.name}
                            is-leaf={item.node.isLeaf}
                            child-items={item.node.children}
                            aria-label={item.node.label}
                            aria-expanded={item.node.strexpanded}
                            level={nextLevel}
                            is-vertical={isVertical}
                            
                            menu-aria-announcement={menuAriaAnnouncement}

                            brand-navigation-color-text={brandNavigationColorText}
                            brand-navigation-bar-background-color={brandNavigationBarBackgroundColor}
                            brand-navigation-background-color={brandNavigationBackgroundColor}
                            font-family={fontFamily}
                            text-transform={textTransform}
                            top-level-item-spacing={topLevelItemSpacing}
                            menu-alignment={menuAlignment}

                            data-is-vertical={isVertical}
                            data-level={nextLevel}
                            data-role="treeitem"
                        >
                        </c-tree-item>
                    </template>
                </li>
            </template>
        </ul>
        </template>
        <template if:false={isRoot}>
            
            <div class="slds-tree__item" data-is-leaf={isLeaf} data-is-vertical={isVertical} tabindex="-1" onclick={handleClick} role={linkRole}>
                <template if:true={computedIconName}>
                    <button if:true={computedIconPositionLeft}
                        type="button"
                        class={computedButtonClass}
                        title={buttonLabel}
                        tabindex="-1"
                        aria-expanded={isExpanded}
                    >
                        
                        <c-primitive-icon
                            icon-name={computedIconName}
                            variant="bare"
                            svg-class="slds-button__icon slds-button__icon_small"
                            no-transform="true"
                            data-target-icon-type="chevron"
                            tabindex={computedIconTabindex}
                            focusable={computedIconFocusable}
                            onclick={handleClick}
                            onkeydown={handleKeydown}

                        >
                            </c-primitive-icon>
                        
                        <span class="slds-assistive-text">
                            {buttonLabel}
                        </span>
                    </button>
                </template>
                <span class="slds-has-flexi-truncate">
                    <span class="slds-hide" id={ariaLabelledById} if:true={isFirstNode}>{computedMenuAriaAnnouncement}</span>
                    <a href={href} tabindex="0" role={linkRole} target={target} class="menuLink" aria-expanded={linkIsExpanded} aria-labelledby={ariaLabelledById} aria-label={linkTitle} title={linkTitle}>
                        <template if:true={icon}>
                            <c-primitive-icon if:true={iconPositionLeft}
                            icon-name={icon}
                            variant="bare"
                            svg-class="slds-button__icon slds-button__icon_small menu-icon slds-m-right_x-small"
                            no-transform="true"
                            >
                            </c-primitive-icon>
                        </template>
                        <span
                            class="slds-tree__item-label slds-truncate"
                            title={label}
                            role={linkRole}
                            >{label}</span>
                        <template if:true={icon}>
                            <c-primitive-icon if:true={iconPositionRight}
                            icon-name={icon}
                            variant="bare"
                            svg-class="slds-button__icon slds-button__icon_small menu-icon slds-m-left_x-small"
                            no-transform="true"
                            >
                            </c-primitive-icon>
                        </template>
                        <template if:true={metatext}>
                            <span
                                class="slds-tree__item-meta slds-truncate"
                                title={metatext}
                            >
                                <span class="slds-assistive-text">:</span>{metatext}
                            </span>
                        </template>
                    </a>
                </span>
                <button if:true={computedIconPositionRight}
                    type="button"
                    class={computedButtonClass}
                    title={buttonLabel}
                    tabindex="-1"
                >
                    <c-primitive-icon if:true={level}
                        icon-name={computedIconName}
                        variant="bare"
                        svg-class="slds-button__icon slds-button__icon_small"
                        no-transform="true"
                        data-target-icon-type="chevron"
                        tabindex={computedIconTabindex}
                        focusable={computedIconFocusable}
                        onclick={handleClick}
                        onkeydown={handleKeydown}
                    >
                    </c-primitive-icon>
                    <span class="slds-assistive-text">
                        {buttonLabel}
                    </span>
                </button>
            </div>
            
            <template if:true={showExpanded}>
                <div class={groupDivClass}>
                    <ul>
                        <template for:each={children} for:item="item">
                            <li class="groupMenuItem" key={item.node.key}>
                                <template if:true={item.node.isLeaf}>
                                    <c-tree-item
                                        role="treeitem"
                                        data-key={item.node.key}
                                        key={item.node.key}
                                        node-key={item.node.key}
                                        aria-selected={item.selected}
                                        aria-level={item.node.level}
                                        label={item.node.label}
                                        href={item.node.href}
                                        target={item.node.target}
                                        icon={item.node.icon}
                                        icon-position={item.node.iconPosition}
                                        metatext={item.node.metatext}
                                        node-ref={item.node.nodeRef}
                                        is-expanded={item.node.isExpanded}
                                        is-disabled={item.node.isDisabled}
                                        focused-child={item.node.focusedChild}
                                        nodename={item.node.name}
                                        is-leaf={item.node.isLeaf}
                                        child-items={item.node.children}
                                        level={nextLevel}
                                        is-vertical={isVertical}
                                        
                                        menu-aria-announcement={menuAriaAnnouncement}
                                        
                                        brand-navigation-color-text={brandNavigationColorText}
                                        brand-navigation-bar-background-color={brandNavigationBarBackgroundColor}
                                        brand-navigation-background-color={brandNavigationBackgroundColor}
                                        font-family={fontFamily}
                                        text-transform={textTransform}
                                        top-level-item-spacing={topLevelItemSpacing}
                                        menu-alignment={menuAlignment}

                                        data-is-vertical={isVertical}
                                        data-level={nextLevel}
                                        data-role="treeitem"
                                    >
                                    </c-tree-item>
                                </template>
                                <template if:false={item.node.isLeaf}>
                                    <c-tree-item
                                        role="treeitem"
                                        data-key={item.node.key}
                                        key={item.node.key}
                                        node-key={item.node.key}
                                        aria-selected={item.selected}
                                        aria-level={item.node.level}
                                        label={item.node.label}
                                        href={item.node.href}
                                        target={item.node.target}
                                        icon={item.node.icon}
                                        icon-position={item.node.iconPosition}
                                        metatext={item.node.metatext}
                                        node-ref={item.node.nodeRef}
                                        is-expanded={item.node.isExpanded}
                                        is-disabled={item.node.isDisabled}
                                        focused-child={item.node.focusedChild}
                                        nodename={item.node.name}
                                        is-leaf={item.node.isLeaf}
                                        child-items={item.node.children}
                                        aria-label={item.node.label}
                                        aria-expanded={item.node.strexpanded}
                                        level={nextLevel}
                                        is-vertical={isVertical}
                                        
                                        menu-aria-announcement={menuAriaAnnouncement}

                                        brand-navigation-color-text={brandNavigationColorText}
                                        brand-navigation-bar-background-color={brandNavigationBarBackgroundColor}
                                        brand-navigation-background-color={brandNavigationBackgroundColor}
                                        font-family={fontFamily}
                                        text-transform={textTransform}
                                        top-level-item-spacing={topLevelItemSpacing}
                                        menu-alignment={menuAlignment}

                                        data-is-vertical={isVertical}
                                        data-level={nextLevel}
                                        data-role="treeitem"
                                    >
                                    </c-tree-item>
                                </template>
                            </li>
                        </template>
                    </ul>
                </div>
            </template>
        </template>
    </div>
</template>